/*!
 * Copyright (c) 2010-2015 EEFUNG Software Co.Ltd. All rights reserved.
 * 版权所有 (c) 2010-2015 湖南蚁坊软件有限公司。保留所有权利。
 */

"use strict";

/**
 *
 * Created by wuyaoqian on 16/3/29.
 */

// 只初始化一次全局日志配置信息（主要是将原来的json变成js -- 方便写注释）
require("log4js-config").init(function () {
    return require("./config/app-logging.js");
});

var CasterClient = require('../index');

CasterClient.topicManage.getInstance('test-topic').then(function (instance) {

    var publish = function (val) {
        var startTime = new Date().getTime();
        instance.publish(val).then(function () {
            var elapsed = new Date().getTime() - startTime;
            console.log('publish success, time: %ss, val: ', elapsed / 1000, val);
        });
    };

    // topic.addMessageListener(function (e) {
    //     console.log('receive message: ', e);
    // });

    publish('⚐中💦2😭‍🙆😔5');

    var count = 1;
    setInterval(function () {
        var key = '(instance1) key-' + (count++);
        publish(key + '⚐中💦2😭‍🙆😔5');
    }, 2000);

});