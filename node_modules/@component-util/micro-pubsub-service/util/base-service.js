/*!
 * Copyright (c) 2010-2020 EEFUNG Software Co.Ltd. All rights reserved.
 * 版权所有 (c) 2010-2020 湖南蚁坊软件股份有限公司。保留所有权利。
 */

'use strict';

const {createSubClazz, clazzCheck} = require('./service-util.js');

/**
 * base-service.js
 * Created by wuyaoqian on 2020/3/14.
 */

class BaseService {

    /**
     * 获取一个本地服务，本服务所发布的资源都将只局限在这个本地服务内
     * @param {string} [clazzName=null] - 本地服务的名称（为空：生成一个不可复用的本地服务，正常：生成一个可被复用的本地服务）
     * @return {SubClazz}
     */
    static getService (clazzName = null) {
        clazzCheck(this, BaseService, 'getService');
        if (!clazzName || typeof clazzName !== 'string') {
            return createSubClazz(this, `Sub${this.name}`);
        }
        let storeName = '__dynamic_sub_clazz__';
        clazzName = `${clazzName.substr(0, 1).toUpperCase()}${clazzName.substr(1)}`;
        if (!this.hasOwnProperty(storeName)) {
            Object.defineProperty(this, storeName, {value: {}});
        }
        return this[storeName][clazzName] || (this[storeName][clazzName] = createSubClazz(this, clazzName));
    }

}

/**
 * 静态方法：
 * 0. getService             // function(name) { return SubBaseService; }
 *
 * @type {BaseService}
 */
module.exports = BaseService;