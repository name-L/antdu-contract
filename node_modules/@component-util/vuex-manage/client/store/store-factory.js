/* eslint-disable */
import Vue from 'vue';
import Vuex from 'vuex';
import _ from 'lodash';

const create = function ({envUtils, initState, globalModules, storeAppPaths, storeAppModule}) {
    let store = create._store;
    if (!store) {
        Vue.use(Vuex);
        store = create._store = new Vuex.Store({
            state: Object.assign({}, initState),
            mutations: {
                updateLoginUser (state, newLoginUser) {
                    state.loginUser = {...newLoginUser};
                }
            },
            modules: globalModules
        });
    } else {
        if (!_.isEmpty(globalModules)) {
            for (let path in globalModules) {
                if (modules[path]) {
                    store.registerModule(path, globalModules[path]);
                }
            }
        }
    }

    if (storeAppPaths && storeAppModule) {
        store.registerModule(storeAppPaths, storeAppModule);
    }

    return {store};
};

export default {create};
